!function(a,b){var c={},d=a.pict=function(a){return c[a]?c[a]:c[a]=new d.fn.init(a)};d.fn=d.prototype={init:function(a){this.id=a,this.$video=h("#"+a),this.video=this.$video[0],this.fullscreenEnabled=b.fullscreenEnabled||b.webkitFullscreenEnabled||b.mozFullScreenEnabled},setup:function(a){var c={controls:!1};return this.config=h.extend(c,a),this.video.controls=this.config.controls,this.el=b.createElement("div"),this.el.className="pict-player",this.inner=b.createElement("div"),this.inner.className="pict-inner",this.video.parentNode.insertBefore(this.el,this.video),this.video.parentNode.removeChild(this.video),this.inner.appendChild(this.video),this.el.appendChild(this.inner),h(this.el).css({width:this.$video.attr("width")||this.$video.width(),height:this.$video.attr("height")||this.$video.height()}),this.$video.removeAttr("width height"),this.controlbar=new e(this,this.config.controlbar),this.on("click",h.proxy(this.toggle,this)),this},handle:function(a,c,d){return c.match(/\bfullscreen/)&&h(b)[a]("webkitfullscreenchange mozfullscreenchange fullscreenchange",d),c=c.replace(/volume\b/,"volumechange"),c=c.replace(/(time\b|position)/,"timeupdate"),this.$video[a](c,d),this},on:function(a,b){return this.handle("on",a,b)},off:function(a,b){return this.handle("off",a,b)},load:function(a){return this.video.src=a,this.video.load(),this},toggle:function(){return this.play(!this.video.paused)},play:function(a){return a?this.video.pause():this.video.play(),this},pause:function(){return this.video.pause(),this},mute:function(a){return this.video.muted=a?!1:!0,this},volume:function(a){return this.video.muted=!1,a&&(this.video.volume=a),this},fullscreen:function(a){if(a)this.normalscreen();else{var b=this.inner,c=b.requestFullScreen||b.webkitRequestFullScreen||b.mozRequestFullScreen;c.call(b)}return this},normalscreen:function(){var a=b.cancelFullScreen||b.webkitCancelFullScreen||b.mozCancelFullScreen;return a.call(b),this},isFullscreen:function(){return!!(b.fullscreenElement||b.webkitIsFullScreen||b.mozFullScreenElement)}},d.fn.init.prototype=d.fn;var e=function(a,b){this.api=a,this.id=0;var c={template:'<div class="pict-controls"><div class="pict-left"><a class="pict-play"></a></div><div class="pict-right"><span class="pict-time">00:00</span><a class="pict-mute"></a><a class="pict-fullscreen"></a></div><div class="pict-center"><div class="pict-bar"><div class="pict-progress"></div><div class="pict-position"></div></div></div></div>',delay:1e3};this.config=h.extend(c,b),this.el=h.parseHTML(this.config.template)[0],this.$el=h(this.el),a.inner.appendChild(this.el),this.progressBar=new f({el:".pict-progress"}),this.positionBar=new f({el:".pict-position",handle:!0,change:h.proxy(this.change,this)}),this.listenTo(h(a.el),"mousemove",h.throttle(this.delayedHide,this.config.delay-10)),this.listenTo(this.$el,"click",this.click),this.listenTo(this.$el,"transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",this.hideEnd),this.listenTo(a,"play pause volume fullscreen",this.render),this.listenTo(a,"loadedmetadata timeupdate",this.position),this.listenTo(a,"progress",this.progress),this.events={show:new g,hide:new g}};e.prototype={listenTo:function(a,b,c){a.on(b,h.proxy(c,this))},on:function(a,b){return this.events[a].on(b),this},off:function(a,b){return this.events[a].off(b),this},delayedHide:function(){this.show(),this.api.video.paused||(this.id=setTimeout(h.proxy(this.hide,this),this.config.delay))},show:function(){return clearTimeout(this.id),0==this.$el.css("opacity")&&(this.$el.css({visibility:"visible",opacity:1}),this.events.show.trigger()),this},hide:function(){return 1==this.$el.css("opacity")&&(this.$el.css({opacity:0}),this.events.hide.trigger()),this},hideEnd:function(){0==this.$el.css("opacity")&&this.$el.css({visibility:"hidden"})},click:function(a){a.preventDefault&&a.preventDefault(),"A"==a.target.nodeName&&this.action(a)},action:function(a){var b=a.target.className.match(/pict-([^\s]*)/);b&&"play,mute,fullscreen".match(b[1])&&this.api[b[1]]("true"===h(a.target).attr("data-state"))},change:function(a){this.api.video.currentTime=this.api.video.duration*a/100},render:function(){this.delayedHide(),h(".pict-play").attr("data-state",!this.api.video.paused),h(".pict-mute").attr("data-state",this.api.video.muted),this.api.fullscreenEnabled&&h(".pict-fullscreen").attr("data-state",this.api.isFullscreen())},position:function(){var a=this.api.video,b=a.currentTime||a.duration;h(".pict-time").html(h.formatTime(b)),this.positionBar.val(a.currentTime/a.duration*100)},progress:function(){var a=this.api.video;a.buffered.length>0&&this.progressBar.val(a.buffered.end(a.buffered.length-1)/a.duration*100)}};var f=function(a){var c=!1;this.el=h(a.el)[0],this.div=b.createElement("div"),this.el.appendChild(this.div);var d=b.createElement("p");this.el.appendChild(d);var e=function(a){c="mousedown"===a.type,f(a)};h(d).on("mousedown",e),h(b).on("mouseup",e);var f=function(b){if(c){b.preventDefault&&b.preventDefault();var e=b.pageX-g(d).left;return"function"==typeof a.change&&a.change.call(this,e/d.clientWidth*100),!1}};h(b).on("mousemove",h.throttle(f,33)),this.a=b.createElement("a"),a.handle&&(this.el.appendChild(this.a),this.a.onmousedown=e);var g=function(a){var b=0,c=0;do b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop;while(a=a.offsetParent);return{left:b,top:c}}};f.prototype={val:function(a){this.div.style.width=a+"%",this.a.style.left=a+"%",this.a.style.marginLeft=-this.a.clientWidth*a/100+"px"}};var g=function(){var a=[];this.on=function(b,c){return a.push({fn:b,c:c}),this},this.trigger=function(){for(var b=[].slice.call(arguments),c=0;c<a.length;c++)a[c].fn.apply(a[c].c||this,b);return this},this.off=function(b){if(b)for(var c=0;c<a.length;c++)a[c]===b&&(a.splice(c,1),c--);else a=[];return this}},h=function(a,b){return new h.fn.init(a,b)};h.fn=h.prototype={length:0,calls:[],init:function(a,c){c=c||b,"string"==typeof a?[].push.apply(this,c.querySelectorAll(a)):a.nodeType&&[].push.apply(this,[a])},each:function(a){return h.each(this,a,this)},attr:function(a,b){return void 0===b?this[0].getAttribute(a):this.each(function(c){c.setAttribute(a,""+b)})},removeAttr:function(a){return a=a.split(" "),this.each(function(b){for(var c=0;c<a.length;c++)b.removeAttribute(a[c])})},css:function(b){return"string"==typeof b?this[0].style[b]||a.getComputedStyle(this[0])[b]:this.each(function(a){for(var c in b){var d=b[c];isNaN(d)||"zIndex,opacity".match(c)||(d+="px"),a.style[c]=d}})},on:function(a,b){a=a.split(" "),b.guid=b.guid||h.guid++;for(var c=0;c<a.length;c++){var d=a[c],e=function(a){var c=function(c){b.call(a,c)};return a.addEventListener?a.addEventListener(d,c,!1):a.attachEvent&&a.attachEvent("on"+d,c),{type:d,el:a,fn:b,wrap:c,guid:b.guid}};[].push.apply(h.fn.calls,h.map(this,e,this))}return this},off:function(a,b){var c=h.fn.calls;a=a.split(" ");for(var d=0;d<a.length;d++){var e=a[d],f=function(a){for(var d=0;d<c.length;d++){var f=c[d];f.el!==a||f.type!==e&&e||f.guid!==b.guid&&b||(a.removeEventListener?a.removeEventListener(f.type,f.wrap,!1):a.detachEvent&&a.detachEvent("on"+f.type,f.wrap),c.splice(d,1),d-=1)}};this.each(f)}return this},html:function(a){return this.each(function(b){b.innerHTML=a})}},h.fn.init.prototype=h.fn,h.extend=function(a){for(var b=[].slice.call(arguments,1),c=0;c<b.length;c++)for(var d in b[c])a[d]=b[c][d];return a},h.extend(h,{guid:1,each:function(a,b,c){if(null!=a){if(a.forEach)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d,a);else for(var f in a)b.call(c,a[f],f,a);return a}},map:function(a,b,c){var d=[];return null==a?d:a.map?a.map(b,c):(h.each(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)},proxy:function(a,b){var c=[].slice.call(arguments,2),d=function(){return a.apply(b||this,c.concat([].slice.call(arguments)))};return d.guid=a.guid=a.guid||h.guid++,d},parseHTML:function(a){var c=b.createElement("div");return c.innerHTML=a,c.childNodes},formatTime:function(a){var b=parseInt(a/3600,10),c=parseInt(a%3600/60,10),d=parseInt(a%3600%60,10);return(0===b?"":10>b?"0"+b+":":b+":")+(10>c?"0"+c:""+c)+":"+(10>d?"0"+d:""+d)},throttle:function(a,b,c){var d,e,f,g=null,h=0;c=c||{};var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}}})}(window,document);